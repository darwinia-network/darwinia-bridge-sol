// SPDX-License-Identifier: Apache-2.0

pragma solidity 0.7.6;
pragma abicoder v2;

import "../../test.sol";
import "../../../truth/bsc/BSCLightClient.sol";

contract BSCLightClientTest is BSCLightClient, DSTest {
// seth call 0x0000000000000000000000000000000000000400 "state_storage(bytes)" 0xdeeff83c81d2e28f78ad5890b33244d67d2d5aca142f290829575a29c215c204 --rpc-url http://localhost:9933
    function test_state_storage() public {}

    function test_decode_state_root_from_header() public {
        bytes memory header = hex'13c961ed5f769065f7422aac798b4387dc2a64b9e4dceb2bdc40411b041aa8161dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d493471284214b9b9c85549ab3d2b972df0deef66ac2c9e13bb7b92c2c2dc68319aa45a7ef3bf7210c404b8cf1639965b5b9b1e6f5616f62c6d4a27855a899a6a12d8c8b20a9e4f694ffbdf602af64ba7ee7e233a0ebf1dfc86f02f4124d6925692f9002d8199ecdc1516b78d73c100dd57ec56477684918200400000000c00048000080040000820000000000000000004008040000010080004a00000110a0000201004040002001000000400000000000200820008000080000000060000800000800010020201000000008000400000001c005000100a00020020200400400000000080a000a4029400048420000004010c4000100000004000000210000250000000c0000020004411100000804002840000000200200000206080000400404020000400000801004000880800000000000000000000800020180200048080000000004100108280208002050000040020000200008104000400000804900000000000080400000000000004825290000000000000200000000000000000000000000000000000000000000000000000000000000201e020100000000bef9c7010000000000000000000000000000000000000000000000000000000022051b00000000000000000000000000000000000000000000000000000000003a071262000000000504d683010108846765746886676f312e3137856c696e757800000000005865ba3c1284214b9b9c85549ab3d2b972df0deef66ac2c935552c16704d214347f29fa77f77da6d75d7c7524df189c73c714dd636a99aa4f3317ccd72a05d62980a75ecd1309ea12fa2ed87a8744fbfc9b863d5a2959d3f95eae5dc7d70144ce1b73b403b7eb6e0adac84746417fbfba17480e6cbc1360bca54330eb71b214cb885500844365e95cd9942c7276e7fd8f474cf03cceff28abc65c9cbae594f725c80e12d700c045a050dadc95c245212a6dcd8945128c225b7ff57a381ee35bea5f9e777430f57df76f862affc146bfe85a5e06b999555d9a213b53ea228eb08c89fbe14010000000000000000000000000000000000000000000000000000000000000000200000000000000000';
        bytes32 state_root = decode_state_root_from_header(header);
        assertEq(state_root, hex'e13bb7b92c2c2dc68319aa45a7ef3bf7210c404b8cf1639965b5b9b1e6f5616f');
    }

    function test_decode_state_root_from_header2() public {
        bytes memory header = hex'000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000003642a9a3f5769fbc24bd736eb5dc81ca663dd1f8b6a9f294fedfb4d43d9194c11dd1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347a2959d3f95eae5dc7d70144ce1b73b403b7eb6e00556c6bfceb4595b11f1efd339c6a0841ab1009c8de1c821bdfc05175e9ecf3171ec83a4e5176046dab6255a6c3afd6cf8144ab5907d4431d521144b2174373a61bf3a54af15912a2e3661ae5458265a48567c1bf41e9c54638d5f6ed7cba59400020000000000000040000000004000810000000000002000004000000000000008000000200000200000000000100000010000000000000000000001002008000000100000800000000008000000002010000000000000a0000000000040000000002000024000040000000000000408400100010000000002001000080100200000002000000001000000000000000000244002400000800000000000002000000002000000000000008000000000000000000000000000000000000000000000000a0040000000004000000000000000080000080400000000020000000000000000000002000100000000000080000100000000004000000800000004000200000000000000000000000000000000000000000000000000000000000000b037fe000000000080c3c9010000000000000000000000000000000000000000000000000000000091d50d0000000000000000000000000000000000000000000000000000000000604e0662000000005504d683010108846765746886676f312e3137856c696e757800000000005865ba3c049153b8dae0a232ac90d20c78f1a5d1de7b7dc51284214b9b9c85549ab3d2b972df0deef66ac2c935552c16704d214347f29fa77f77da6d75d7c7524df189c73c714dd636a99aa4f3317ccd72a05d62980a75ecd1309ea12fa2ed87a8744fbfc9b863d5a2959d3f95eae5dc7d70144ce1b73b403b7eb6e0adac84746417fbfba17480e6cbc1360bca54330eb71b214cb885500844365e95cd9942c7276e7fd8f474cf03cceff28abc65c9cbae594f725c80e12d862d7205d7212bea8032fe2d71b6e182e72ccf9a18e2bddb9ffdfc189587c2f20a17afce0ccf13fb0b7eab75bffb94483caf97cdb63751c0fa85ba6120e397ed00000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000';
        bytes32 state_root = decode_state_root_from_header(header);
        assertEq(state_root, hex'9f294fedfb4d43d9194c11dd1dcc4de8dec75d7aab85b567b6ccd41ad312451b');
    }
}
