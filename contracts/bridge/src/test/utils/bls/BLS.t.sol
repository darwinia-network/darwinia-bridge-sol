// SPDX-License-Identifier: MIT
pragma solidity 0.7.6;
pragma abicoder v2;

import "../../test.sol";
import { BLS } from "../../../utils/bls/BLS.sol";
import { B12 } from "../../../utils/bls/BLS12381.sol";

contract BLSTest is DSTest {

    function test_bls_pairing_check() public {
        B12.G1Point memory key_point = B12.G1Point({
            X: B12.Fp({
                a: 26627434292402230803163858128455585914,
                b: 48634982462735808718895679799386069894578484234911513006586203230657604913836
            }),
            Y: B12.Fp({
                a: 14856821957515554002181972608605741852,
                b: 25416517180090498104081766963124621484473644952830749638673217029993138557934
            })
        });

        B12.G2Point memory msg_hash = B12.G2Point({
            X: B12.Fp2({
                a: B12.Fp({
                    a: 440249405659325969529968607583110888,
                    b: 8287011717308296271484778081523466175176315688302323040678920909110172052883
                }),
                b: B12.Fp({
                    a: 24020475586686358824048391002731990219,
                    b: 70759422662205377238812159328664300970743143867490115357570028073099023505250
                })
            }),
            Y: B12.Fp2({
                a: B12.Fp({
                    a: 1386680577929784893551049599873021837,
                    b: 27514265084368602307416113347133013730132425074985547665978961921775804054489
                }),
                b: B12.Fp({
                    a: 29803136074860227348525644626316084686,
                    b: 27012386664933262761093142209614962474294368617355502707705554906602519553290
                })
            })
        });

        B12.G2Point memory sig_point = B12.G2Point({
            X: B12.Fp2({
                a: B12.Fp({
                    a: 21119453716311089298661719635637843530,
                    b: 70301835649641000901160347641203690598647566398903256239764622874509047347076
                }),
                b: B12.Fp({
                    a: 5920268386667820052614231331002922384,
                    b: 60500088921229408394397585038144717166868811544401247695705260970207586478821
                })
            }),
            Y: B12.Fp2({
                a: B12.Fp({
                    a: 31295527203677419532351065800929160364,
                    b: 24349246807094560350851965287716353817621039716553532902762100173406977412078
                }),
                b: B12.Fp({
                    a: 6584272192056904658154384891933189686,
                    b: 91936439523527484860611422496069315700431954270715891103668743441226387088003
                })
            })
        });

        assertTrue(BLS.bls_pairing_check(key_point, msg_hash, sig_point));
    }
}
